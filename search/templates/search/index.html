{% load staticfiles %}
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Montserrat+Subrayada" rel="stylesheet">


    <title>Easy Living</title>

    <!-- Bootstrap Core CSS -->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="{% static 'css/clean-blog.min.css' %}" rel="stylesheet">

    <!-- Custom Fonts -->
    <script src="{% static 'js/jquery.js' %}" type="text/javascript"></script>

    <link href="{% static 'css/font-awesome.min.css' %}" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="{% static 'css/bootstrap-slider.min.css' %}">
    <script src="{% static 'css/bootstrap-slider.min.js' %}" type="text/javascript"></script>

    <!-- Leaflet -->
    <link rel="stylesheet" href="{% static 'leaflet/leaflet.css' %} "/>
    <script src="{% static 'leaflet/leaflet-src.js' %}" type="text/javascript"></script>
    <script>
        var map;
        var csrftoken;
        $(document).ready(
            function init_map() {
                csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
                map = L.map('mapid').setView([50.938, 6.95], 10);
                L.tileLayer(
                    'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}',
                    {
                        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
                        maxZoom: 18,
                        //id: 'mapbox.mapbox-streets-v7',
                        //id: 'mapbox.mapbox-terrain-v2',
                        //id: 'mapbox.mapbox-traffic-v1',
                        id: 'mapbox.satellite',
                        accessToken: 'pk.eyJ1IjoicnN0b2RkZW4iLCJhIjoiY2ozdmt0ZDN3MDAydDR1cG1ybXduYjFsZiJ9.1SgNsXjR5DBwU6uEWTZF1A'
                    }
                ).addTo(map);
                //var marker = L.marker([50.938, 6.95]).addTo(map);
                //var poly = L.polygon([[[50.9690877834368,7.00925780777239],[50.9682048669575,7.00911972076204],[50.9673558646356,7.00871076633736],[50.9665734058739,7.00804666038754],[50.9658875641941,7.00715292413179],[50.9653247009086,7.00606390335322],[50.9649064513392,7.00482144850962],[50.9646488926526,7.00347330644385],[50.9645619254045,7.00207128549944],[50.9646488926526,7.00066926455503],[50.9649064513392,6.99932112248925],[50.9653247009086,6.99807866764565],[50.9658875641941,6.99698964686708],[50.9665734058739,6.99609591061134],[50.9673558646356,6.99543180466152],[50.9682048669575,6.99502285023683],[50.9690877834368,6.99488476322648],[50.9699706831334,6.99502285023683],[50.9708196376624,6.99543180466152],[50.9716020248969,6.99609591061134],[50.9722877822047,6.99698964686708],[50.9728505611183,6.99807866764565],[50.9732687391606,6.99932112248925],[50.9735262500543,7.00066926455503],[50.9736132005197,7.00207128549944],[50.9735262500543,7.00347330644385],[50.9732687391606,7.00482144850962],[50.9728505611183,7.00606390335322],[50.9722877822047,7.00715292413179],[50.9716020248969,7.00804666038754],[50.9708196376624,7.00871076633736],[50.9699706831334,7.00911972076204],[50.9690877834368,7.00925780777239]],[[50.9690877834368,7.02363085231831],[50.9655736869431,7.02289622789339],[50.9622988310278,7.02074241805917],[50.959486464264,7.0173162013965],[50.9573283439166,7.01285106890887],[50.9559716414413,7.00765131199632],[50.9555088864332,7.00207128549944],[50.9559716414413,6.99649125900256],[50.9573283439166,6.99129150209],[50.959486464264,6.98682636960237],[50.9622988310278,6.98340015293971],[50.9655736869431,6.98124634310549],[50.9690877834368,6.98051171868057],[50.9726016140884,6.98124634310549],[50.9758757437098,6.98340015293971],[50.9786871183376,6.98682636960237],[50.9808442465492,6.99129150209],[50.9822002227305,6.99649125900256],[50.9826627118967,7.00207128549944],[50.9822002227305,7.00765131199632],[50.9808442465492,7.01285106890887],[50.9786871183376,7.0173162013965],[50.9758757437098,7.02074241805917],[50.9726016140884,7.02289622789339],[50.9690877834368,7.02363085231831]]]).addTo(map);
            }
        );
        /**
         * @global map
         */
        function getCityPoly (cityName) {
            $.ajax(
                './search/cityPolygon',
                {
                    cache: false,
                    dataType: "json",
                    data: {
                        csrfmiddlewaretoken: csrftoken,
                        city: cityName
                    },
                    method: 'POST',
                    success: function (data, textStatus, jqXHR) {
                         var latlngs = makePoints(data[0].way);
                         var polygon = L.polygon(latlngs, {color: 'red'}).addTo(map);
                         map.fitBounds(polygon.getBounds());
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        alert("Error: " + errorThrown
                            + "\nStatus: " + textStatus
                            + "\njqXHR: " + JSON.stringify(jqXHR)
                        );
                    },
                    complete: function (jqXHR, textStatus) {}
                }
            );
        }
        /**
         * 51.0616154051779 6.77253026067161
         */
        function retPoint (pointStr, index, refToArray) {
            var temp = pointStr.split(" ", 2);
            refToArray[index] = [parseFloat(temp[0]), parseFloat(temp[1])];
        }

        /**
         * POLYGON((51.0616154051779 6.77253026067161,51.0616932038293 6.77256430682088,51.0622437751639 6.77280460615938,51.0633110812758 6.77339956037205))
         */
        function makePoints (polygonPointsStr) {
            var retVal = polygonPointsStr.substring(9, polygonPointsStr.length - 2).split(',');
            retVal.forEach(retPoint);
            return retVal;
        }
    </script>



</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li>
                        <a href="contact.html">Contact</a>
                    </li>

                </ul>
            </div>

        </div>

    </nav>

    <!-- Page Header -->
    <header class="intro-header" style="background-image: url({% static 'css/Köln1.jpg' %})">
			<div class="container">
				<div class="row">
					<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
						<div class="site-heading">
							<h1>EasyLiving</h1>
							<hr class="small">
						</div>
                    </div>

                            </div>
							<br/>
					</div>
				</div>
			</div>
		</header>

        <div class="container-fluid">
          <div class="col-xs-5">
		<div id="mapid" class="mapcanvas" style="border:1px solid #000000; width:640px; height:480px;"></div>
          </div>


        <div class="col-xs-3">
            <div class="search-field">
                <form method="post" action="">
                {% csrf_token %}
                    <div class="row">
                        <!--<div class="col-xs-4">-->
                            <div class="form-group">
                              <label class="suchLabel" id ="inputLabelSuche" for="town">Suche nach Stadt:</label>
                              <input type="text" class="form-control" name="suchanfrage" id = "town" value=""/> <!-- Die folgende Zeile ermöglicht über das Attribut "name" den Zugriff auf den Inhalt des Textfeldes -->
                            </div>
                            <div class="list-group">
                              <a href="#" class="list-group-item list-group-item-action active " id="auswahl1">Auswahl 1</a>
                              <a href="#" class="list-group-item list-group-item-action">Auswahl 2</a>
                              <a href="#" class="list-group-item list-group-item-action">Auswahl 3</a>
                              <a href="#" class="list-group-item list-group-item-action">Auswahl 4</a>
                            </div>
                            <button id="searchbutton" type="submit" href="#canvas" name="submitsuche" class="btn btn-default">Suchen</button>
                    </div>
                </form>
            </div>

        </div>


            <div class="col-xs-2 ">
                <form method="post" action="">
                {% csrf_token %}
                <button id="addfilter" type="submit"  name="submitfilter" class="btn btn-default" onclick='addFilter()'>Filter hinzufügen</button></br></br>
                        <div class="dropdown">
                          <button  class="btn btn-primary dropdown-toggle" type="button"  data-toggle="dropdown">Kinder & Bildung<span class="caret"></span></button>
                              <ul class="dropdown-menu">
                                  <li><a href="#" name="checks2[]" class="dropdownauswahl" data-value="1"><input type="checkbox" class="sliderfilter" id="1" value="school"/>Schulen</a></li>
                                  <li><a href="#" name="checks2[]" class="dropdownauswahl" data-value="2"><input type="checkbox" class="sliderfilter" id="2" value="kindergarten"/>Kindergärten</a></li>
                                  <li><a href="#" name="checks2[]" class="dropdownauswahl" data-value="3"><input type="checkbox" class="sliderfilter" id="3" value="playground"/>Spielplatz</a></li>
                                  <li><a href="#" name="checks2[]" class="dropdownauswahl" data-value="4"><input type="checkbox" class="sliderfilter" id="4" value="pharmacy"/>Apotheken</a></li>
                                  <li><a href="#" name="checks2[]" class="dropdownauswahl" data-value="5"><input type="checkbox" class="sliderfilter" id="5" value="doctors"/>Ärzte</a></li>
                                  <li><a href="#" name="checks2[]" class="dropdownauswahl" data-value="6"><input type="checkbox" class="sliderfilter" id="6" value="hospital"/>Krankenhäuser</a></li>
                              </ul>
                        </div>
                </form>


            </div>

                <div class="col-md-2">
                    <div>
                    Umkreis in Metern:<br> <b>1m</b> <input id="ex2" data-slider-id='ex2Slider' type="text" class="span2" value="" data-slider-min="1" data-slider-max="2500" data-slider-step="5" data-slider-value="[750,1250]"/> <b>2500m</b>
                    </div>
                </br></br>
                    <textarea id="filter" rows="10" cols="20"></textarea>

                </div>
            </div>
    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="col">
                <!--<div class="Logo" style="image: url({% static 'css/Logo_transparent.jpg' %})">-->
                    <!--<img src="Logo_transparent.png" class="img-responsive" alt="Logo">-->

                </div>
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; EasyLiving 2017</p>
                </div>
            </div>
        </div>
    </footer>
 
 


<script>
    var slider = new Slider('#ex2', {});

    function getFilter(){



        <!--var checkedValue = document.querySelector('.dropdownauswahl:checked').value;-->
        <!--var townName = document.getElementById('schule').value;-->
        var x = "";
        if (document.getElementById("1").checked == true){
            var x = document.getElementById("1").value;
        } else if (document.getElementById("2").checked == true){
            var x = document.getElementById("2").value;
        } else if (document.getElementById("3").checked == true){
            var x = document.getElementById("3").value;
        } else if (document.getElementById("4").checked == true){
            var x = document.getElementById("4").value;
        } else if (document.getElementById("5").checked == true){
            var x = document.getElementById("5").value;
        } else if (document.getElementById("6").checked == true){
            var x = document.getElementById("6").value;
        } else {
        alert("Bitte einen Filter auswählen!")
        return Null;
        }
        <!--document.getElementById("auswahl1").innerHTML=x;-->
        return x;
    }

    function getUmkreis(){
        var umrkeis = ""
        var umkreis = document.getElementById("ex2").value;
        return umkreis
    }

    function addFilter() {

        <!--var para = document.createElement("P");-->
        <!--var t = document.createTextNode("This is a paragraph.");-->
        <!--para.appendChild(t);-->
        <!--document.getElementById("filter").appendChild(para);-->
        text = "Text";
        document.getElementById("filter").value += getFilter() + ": " + getUmkreis() + '\n';
        document.getElementById("addfilter").value += getFilter() + ": " + getUmkreis();
    }


</script>
<button onclick="getCityPoly('Köln')">Get Köln Polygon</button>
<button onclick="getCityPoly('Düsseldorf')">Get Düsseldorf Polygon</button>
<button onclick="getCityPoly('Bielefeld')">Get Bielefeld Polygon</button>

</body>
</html>
